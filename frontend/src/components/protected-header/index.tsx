import Link from "next/link";

import { Button } from "@src/components/ui/button";
import { paths } from "@src/lib/paths";
import { AdminCreateLink } from "@src/modules/admin/components/admin-create-button";
import { getCurrentUser } from "@src/modules/auth/lib/dal";
import { ROLES } from "@src/types/user";

import { SidebarTrigger } from "../ui/sidebar";
import ActionDropdown from "./action-dropdown";
import UserMenuTrigger from "./user-menu-trigger";

export default async function ProtectedHeader() {
	const user = await getCurrentUser();

	return (
		<header className="px-4 bg-sidebar sticky top-0 z-50 min-h-(--admin-header-height-mobile) lg:min-h-(--admin-header-height) grid grid-cols-2 items-center gap-4">
			<div className="flex items-center gap-4">
				<div className="lg:hidden">
					<SidebarTrigger />
				</div>
				<Button
					variant="link"
					className="w-[160px] md:w-[271px] h-full md:h-[64px] p-0! mr-auto justify-start"
					asChild
				>
					<Link href={paths.agent.properties.index()}>
						<svg
							className="w-full! h-full!"
							width="271"
							height="64"
							viewBox="0 0 271 64"
							fill="none"
							xmlns="http://www.w3.org/2000/svg"
						>
							<title>Red Prop Logo</title>
							<path
								d="M34.7482 60.497H14.2482V55.997H18.25M34.7482 60.497H55.2482V55.997H51.75M34.7482 60.497V44.997M34.7482 44.997L18.7482 28.997C18.7482 28.997 15.683 28.5254 14.2482 30.1728M34.7482 44.997L50.7482 28.997C50.7482 28.997 53.813 28.2899 55.2482 29.9503M25.75 45.9988L13.7482 33.997C13.2782 32.1172 13.5935 30.9245 14.2482 30.1728M43.7463 45.9988L55.7482 33.997C56.2189 31.9597 55.9033 30.7083 55.2482 29.9503M51.75 55.997V51.4978L62.75 40.4978V13.4978C62.75 13.4978 58.75 6.99778 55.2482 13.4978V29.9503M51.75 55.997H18.25M18.25 55.997V51.4978L7.25 40.4978V13.4978C7.25 13.4978 10.75 7.50342 14.2482 13.4978V30.1728M29.25 33.997V21.0034H40.25V33.997M47.25 28.0034V18.0034M47.25 18.0034L35.25 9.00342L20.75 19.5034L18.25 15.5034L35.25 3.50342L43.25 9.50342M47.25 18.0034L49.25 19.5034L51.25 15.5034L47.75 12.8784M47.75 12.8784V3.50342H43.25V9.50342M47.75 12.8784L43.25 9.50342M23.25 28.0034V18.0034"
								stroke="#1A3D64"
								strokeWidth="3"
								strokeLinecap="round"
							/>
							<path
								d="M74.5136 45.5V19.9308H81.8468C84.3817 19.9308 86.4123 20.4481 87.9384 21.4828C89.4645 22.4916 90.2276 24.2247 90.2276 26.682C90.2276 28.7255 89.6327 30.3292 88.4428 31.4932C87.2788 32.6572 85.688 33.3685 83.6704 33.6272L90.732 45.5H88.6756L81.7304 33.7436H76.2984V45.5H74.5136ZM76.2984 32.2692H81.3812C83.6316 32.2692 85.3647 31.8165 86.5804 30.9112C87.7961 29.98 88.404 28.5703 88.404 26.682C88.404 24.7679 87.7961 23.4228 86.5804 22.6468C85.3647 21.8449 83.6316 21.444 81.3812 21.444H76.2984V32.2692ZM95.6187 45.5V19.9308H109.625V21.4828H97.4035V31.144H107.647V32.696H97.4035V43.948H110.013V45.5H95.6187ZM115.587 45.5V19.9308H121.523C124.162 19.9308 126.335 20.4611 128.042 21.5216C129.749 22.5563 131.017 24.0177 131.844 25.906C132.698 27.7943 133.125 30.0317 133.125 32.6184C133.125 35.2051 132.698 37.4684 131.844 39.4084C131.017 41.3225 129.749 42.8228 128.042 43.9092C126.335 44.9697 124.175 45.5 121.562 45.5H115.587ZM117.372 43.9868H121.329C123.657 43.9868 125.546 43.5083 126.994 42.5512C128.469 41.5683 129.542 40.2232 130.215 38.516C130.913 36.8088 131.262 34.8429 131.262 32.6184C131.262 30.3939 130.913 28.4539 130.215 26.7984C129.542 25.1171 128.469 23.8108 126.994 22.8796C125.546 21.9225 123.657 21.444 121.329 21.444H117.372V43.9868ZM139.003 45.5V19.9308H145.444C148.341 19.9308 150.605 20.4611 152.234 21.5216C153.89 22.5821 154.717 24.4316 154.717 27.07C154.717 29.5791 153.903 31.4544 152.273 32.696C150.669 33.9117 148.445 34.5196 145.599 34.5196H140.788V45.5H139.003ZM140.788 33.0064H145.173C147.785 33.0064 149.725 32.5408 150.993 31.6096C152.26 30.6784 152.894 29.1652 152.894 27.07C152.894 24.9231 152.234 23.4487 150.915 22.6468C149.622 21.8449 147.656 21.444 145.017 21.444H140.788V33.0064ZM160.298 45.5V19.9308H167.631C170.166 19.9308 172.197 20.4481 173.723 21.4828C175.249 22.4916 176.012 24.2247 176.012 26.682C176.012 28.7255 175.417 30.3292 174.227 31.4932C173.063 32.6572 171.472 33.3685 169.455 33.6272L176.516 45.5H174.460L167.515 33.7436H162.083V45.5H160.298ZM162.083 32.2692H167.166C169.416 32.2692 171.149 31.8165 172.365 30.9112C173.581 29.98 174.188 28.5703 174.188 26.682C174.188 24.7679 173.581 23.4228 172.365 22.6468C171.149 21.8449 169.416 21.444 167.166 21.444H162.083V32.2692ZM190.288 45.9656C188.245 45.9656 186.434 45.4224 184.856 44.336C183.278 43.2237 182.037 41.6717 181.131 39.68C180.226 37.6883 179.773 35.3344 179.773 32.6184C179.773 29.9283 180.226 27.6003 181.131 25.6344C182.037 23.6685 183.278 22.1553 184.856 21.0948C186.434 20.0084 188.245 19.4652 190.288 19.4652C192.358 19.4652 194.181 20.0084 195.759 21.0948C197.337 22.1553 198.579 23.6685 199.484 25.6344C200.389 27.6003 200.842 29.9283 200.842 32.6184C200.842 35.3344 200.389 37.6883 199.484 39.68C198.579 41.6717 197.337 43.2237 195.759 44.336C194.181 45.4224 192.358 45.9656 190.288 45.9656ZM190.288 44.336C192.021 44.336 193.535 43.8575 194.828 42.9004C196.121 41.9175 197.13 40.5465 197.854 38.7876C198.579 37.0287 198.941 34.9723 198.941 32.6184C198.941 30.2645 198.579 28.234 197.854 26.5268C197.13 24.7937 196.121 23.4616 194.828 22.5304C193.535 21.5733 192.021 21.0948 190.288 21.0948C188.555 21.0948 187.042 21.5733 185.749 22.5304C184.455 23.4616 183.447 24.7937 182.722 26.5268C181.998 28.234 181.636 30.2645 181.636 32.6184C181.636 34.9723 181.998 37.0287 182.722 38.7876C183.447 40.5465 184.455 41.9175 185.749 42.9004C187.042 43.8575 188.555 44.336 190.288 44.336ZM206.714 45.5V19.9308H213.155C216.052 19.9308 218.315 20.4611 219.945 21.5216C221.6 22.5821 222.428 24.4316 222.428 27.07C222.428 29.5791 221.613 31.4544 219.984 32.696C218.38 33.9117 216.155 34.5196 213.31 34.5196H208.499V45.5H206.714ZM208.499 33.0064H212.883C215.496 33.0064 217.436 32.5408 218.703 31.6096C219.971 30.6784 220.604 29.1652 220.604 27.07C220.604 24.9231 219.945 23.4487 218.626 22.6468C217.332 21.8449 215.366 21.444 212.728 21.444H208.499V33.0064Z"
								fill="#1A3D64"
							/>
						</svg>
					</Link>
				</Button>
			</div>
			<div className="justify-self-end flex items-center gap-12">
				<div className="hidden md:block">
					{user?.role === ROLES.AGENT ? (
						<ActionDropdown />
					) : (
						<AdminCreateLink />
					)}
				</div>
				<UserMenuTrigger user={user} />
			</div>
		</header>
	);
}
